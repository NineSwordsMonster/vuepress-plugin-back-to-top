<template>
  <transition name="fade">
    <div
      v-show="visible"
      :style="customStyle"
      class="back-to-ceiling"
      @click="backToTop"
    >
      <svg
        t="1597808273231"
        class="icon"
        viewBox="0 0 1024 1024"
        version="1.1"
        xmlns="http://www.w3.org/2000/svg"
        p-id="652"
        width="200"
        height="200"
      >
        <metadata>IcoFont Icons</metadata>
        <title>rocket-alt-1</title>
        <glyph
          glyph-name="rocket-alt-1"
          unicode="&#xee2b;"
          horiz-adv-x="1000"
        />
        <path d="M526.6 85.2c22.5 22.299999999999997 45.10000000000002 44.499999999999986 65.39999999999998 68.60000000000001 29.700000000000045 35.19999999999999 51.200000000000045 76 67.79999999999995 121.19999999999999h-319.99999999999994c3.099999999999966-8.100000000000023 5.399999999999977-15.5 8.699999999999989-22.5 33-71.69999999999999 77.80000000000001-134.2 141.10000000000002-182.4 2.5-1.8999999999999915 4-5.099999999999994 6-7.599999999999994h4.099999999999966c2.400000000000034 0 14.300000000000011 10.200000000000003 26.900000000000034 22.700000000000003z m-354.20000000000005 638.3l89.10000000000002-51.89999999999998c6.300000000000011-3.7000000000000455 12.800000000000011-7.2000000000000455 19.100000000000023-10.700000000000045 15.199999999999989 62.5 29.899999999999977 123.30000000000007 45.39999999999998 186.89999999999998-49.80000000000001 24.700000000000045-101.1 50.10000000000002-152.6 75.70000000000005-15.900000000000006 7.899999999999977-28.700000000000017-0.10000000000002274-28.700000000000017-17.899999999999977v-134c0-17.700000000000045 12.400000000000006-39.200000000000045 27.700000000000017-48.10000000000002z m653.7 200c-51.10000000000002-25.299999999999955-102-50.60000000000002-152.60000000000002-75.60000000000002 15.100000000000023-62.10000000000002 29.899999999999977-123 45.299999999999955-186.60000000000002 35.60000000000002 20.5 71.80000000000007 41.30000000000007 108.20000000000005 62.200000000000045 15.399999999999977 8.799999999999955 27.799999999999955 30.5 27.799999999999955 48.10000000000002v134c0.10000000000002274 17.799999999999955-12.899999999999977 25.799999999999955-28.699999999999932 17.899999999999977z m-324.20000000000005-621.3c49.5-5.684341886080802e-14 99.10000000000002 0.8999999999999773 148.70000000000005-0.5000000000000568 16.5-0.39999999999997726 22.399999999999977 6 26.600000000000023 20.5 25.5 90 30.5 181.40000000000003 19.699999999999932 273.8-9.5 80.10000000000002-29.100000000000023 157.79999999999995-55.299999999999955 234-4.300000000000068 12.299999999999955-9.5 17.100000000000023-22.800000000000068 17-79.09999999999991-0.6000000000000227-158.29999999999995-0.5-237.39999999999998-0.10000000000002274-11.699999999999989 0.10000000000002274-18-2.5-22.19999999999999-15-38.30000000000001-111.89999999999998-65.5-226.19999999999993-60-345 2.6000000000000227-55.799999999999955 16.19999999999999-111 24.400000000000034-166.59999999999997 2.2999999999999545-15.900000000000034 11.5-18.600000000000023 25.799999999999955-18.400000000000034 50.60000000000002 0.8000000000000114 101.5 0.30000000000001137 152.5 0.30000000000001137z m-94.69999999999999 225.5999999999999c0.4000000000000341 41.700000000000045 10.100000000000023 80.30000000000007 39.19999999999999 111.80000000000007 31.400000000000034 34 75 34 106.5 0.39999999999997726 51.700000000000045-55.200000000000045 53.30000000000007-166.3 3-222.60000000000002-34.10000000000002-38.19999999999999-78.09999999999997-38.5-112-0.2999999999999545-27.899999999999977 31.599999999999966-36.39999999999998 69.89999999999998-36.69999999999999 110.69999999999993z m-37.89999999999998 345h260.7c-5.2999999999999545 19.5-9.600000000000023 38-15.700000000000045 55.80000000000007-1.2999999999999545 4-8.799999999999955 8.5-13.5 8.5-67.39999999999998 0.5-134.79999999999995 0.6000000000000227-201.99999999999994-0.10000000000002274-4.800000000000011-0.10000000000002274-12.300000000000011-5.7999999999999545-13.900000000000034-10.5-6-16.600000000000023-10.099999999999966-34-15.599999999999966-53.700000000000045z" />
      </svg>
    </div>
  </transition>
</template>

<script>
export default {
  name: "BackToTop",
  data() {
    return {
      visible: false,
      /* eslint-disable no-undef */
      customStyle: CUSTOM_STYLE,
      visibilityHeight: VISIBILITY_HEIGHT,
    };
  },
  mounted() {
    window.addEventListener("scroll", this.throttle(this.handleScroll, 500));
  },
  beforeUnmount() {
    window.removeEventListener("scroll", this.throttle(this.handleScroll, 500));
  },
  methods: {
    handleScroll() {
      this.visible = window.pageYOffset > this.visibilityHeight;
    },
    backToTop() {
      window.scrollTo(0, 0);
    },
    throttle(func, delay) {
      let timer = null;
      let startTime = Date.now();
      return function () {
        const curTime = Date.now();
        const remaining = delay - (curTime - startTime);
        const context = this;
        const args = arguments;
        clearTimeout(timer);
        if (remaining <= 0) {
          func.apply(context, args);
          startTime = Date.now();
        } else {
          timer = setTimeout(func, remaining);
        }
      };
    },
  },
};
</script>

<style lang="stylus" scoped>
.back-to-ceiling {
  background-color: #fff;
  background-color: var(--background-color);
  box-shadow: 0 1px 6px 0 rgba(0, 0, 0, 0.2);
  box-shadow: var(--box-shadow);
  position: fixed;
  display: inline-block;
  text-align: center;
  cursor: pointer;

  &::hover {
    background: #d5dbe7;
  }

  .icon {
    position: absolute;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    margin: auto;
    width: 26px;
    height: 26px;
    fill: $accentColor;
  }
}

.fade-enter-active, .fade-leave-active {
  transition: all 0.5s;
}

.fade-enter, .fade-leave-to {
  opacity: 0;
  transform: translateY(-100vh);
}
</style>
